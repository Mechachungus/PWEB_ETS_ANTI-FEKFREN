<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Book Your Stay - East Out Hotel</title>
    
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/litepicker/dist/css/litepicker.css"/>
    <script src="https://cdn.jsdelivr.net/npm/litepicker/dist/litepicker.js"></script>
</head>
<body class="page-no-scroll">

    <header class="minimal-header">
        </header>

    <div id="the-sun"></div>
    <div id="the-moon"></div>

    <main class="page-content">
        
        <section class="content-grid-section">
            <div class="container">
                
                <h2 class="room-page-title">Complete Your Reservation</h2>
                
                <div class="booking-layout">
                    
                    <div class="booking-form">
                        <form id="reservation-form">
                            
                            <h3>Your Details</h3>
                            <div class="form-group">
                                <label for="full-name">Full Name</label>
                                <input type="text" id="full-name" name="full-name" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" name="phone">
                            </div>

                            <h3>Select Dates</h3>
                            <div class="form-group">
                                <label for="date-picker">Check-In & Check-Out</label>
                                <input type="text" id="date-picker" name="date-range" required>
                            </div>
                            <h3>Payment Details</h3>
                            <div class="form-group">
                                <label for="card-name">Name on Card</label>
                                <input type="text" id="card-name" name="card-name" required>
                            </div>
                            <div class="form-group">
                                <label for="card-number">Card Number</label>
                                <input type="text" id="card-number" name="card-number" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="card-expiry">Expiry (MM/YY)</label>
                                    <input type="text" id="card-expiry" name="card-expiry" placeholder="MM/YY" required>
                                </div>
                                <div class="form-group">
                                    <label for="card-cvc">CVC</label>
                                    <input type="text" id="card-cvc" name="card-cvc" placeholder="123" required>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-book btn-full-width">Confirm & Pay</button>

                        </form>
                    </div>
                    
                    <div class="booking-summary">
                        <h3>Your Reservation</h3>
                        <div class="summary-item">
                            <span>Room Type:</span>
                            <strong id="selected-room-type">No room selected</strong>
                        </div>
                        <div class="summary-item">
                            <span>Price per night:</span>
                            <strong id="selected-room-price">-</strong>
                        </div>
                        <div class="summary-divider"></div>
                        <div class="summary-item total">
                            <span>Estimated Total:</span>
                            <strong id="selected-room-total">-</strong>
                        </div>
                        <p class="summary-note">The final price will be calculated based on your selected dates and any applicable taxes.</p>
                    </div>

                </div> </div> </section> </main>

    <footer class="main-footer" id="main-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 East Out Hotel. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // This function will get the locked dates from your backend.
        // For now, it just has fake data for testing.
        // Your colleague will replace the inside of this function.
        function getLockedDatesForRoom(roomType) {
            console.log(`Fetching booked dates for: ${roomType}`);
            // --- FAKE BACKEND DATA (FOR DEMO) ---
            // In the future, your colleague will make this fetch from a real database.
            const fakeBookedDates = {
                'deluxe': ['2025-11-10', '2025-11-11', '2025-11-18', '2025-11-19', '2025-11-20'],
                'executive': ['2025-11-12', '2025-11-13'],
                'luxury': ['2025-11-15']
            };
            // This is what your frontend code will look like:
            // return fetch(`/api/rooms/${roomType}/booked-dates`)
            //     .then(response => response.json())
            //     .then(data => data.lockedDays);
            
            // For now, we return the fake data immediately:
            return Promise.resolve(fakeBookedDates[roomType] || []);
        }

        // --- Get the currently selected room ---
        const params = new URLSearchParams(window.location.search);
        const roomType = params.get('room'); // 'deluxe', 'executive', etc.

        // --- Initialize the Date Picker ---
        // We run this *after* we get the locked dates.
        getLockedDatesForRoom(roomType).then(lockedDays => {
            
            const picker = new Litepicker({
                element: document.getElementById('date-picker'),
                singleMode: false, // This enables "range" selection
                allowRepick: true, // Lets user click new start/end
                format: 'MMM D, YYYY', // How the date looks in the input
                minDate: new Date(), // User can't book in the past
                lockDays: lockedDays, // ⭐️ THIS IS THE AVAILABILITY CHECK
                tooltipText: {
                    one: 'night',
                    other: 'nights'
                },
                setup: (picker) => {
                    // This shows an error if user tries to book a locked range
                    picker.on('tooltip', (tooltip, day) => {
                        if (day.isLocked) {
                            tooltip.innerHTML = 'Sorry, this date is unavailable';
                        }
                    });
                }
            });

        });
    });
</script>

</body>
</html>